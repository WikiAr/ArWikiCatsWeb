# ArWikiCatsWeb

[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/WikiAr/make2-web)

خدمة ويب قائمة على Flask لحل تسميات تصنيفات ويكيبيديا العربية. توفر هذه الخدمة واجهة ويب وواجهة برمجة تطبيقات REST للعمل مع تصنيفات ويكيبيديا العربية.

## المميزات

- **واجهة برمجة التطبيقات REST**: حل تسميات التصنيفات العربية من خلال نقاط النهاية HTTP
- **واجهة الويب**: واجهة مستخدم تفاعلية لاختبار واستكشاف تسميات التصنيفات
- **المعالجة الجماعية**: دعم حل تسميات تصنيفات متعددة في وقت واحد
- **نظام السجلات**: تتبع استخدام واجهة برمجة التطبيقات والأداء باستخدام قاعدة بيانات SQLite
- **دعم CORS**: تم تكوينه للطلبات عبر النطاقات من نطاقات ويكيبيديا
- **مراقبة الحالة**: عرض السجلات وإحصائيات الاستخدام

## المتطلبات

- Python 3.11+
- التبعيات المدرجة في `src/requirements.txt`:
  - flask
  - flask_cors
  - ArWikiCats

## التثبيت

1. استنساخ المستودع:
```bash
git clone https://github.com/WikiAr/ArWikiCatsWeb.git
cd ArWikiCatsWeb
```

2. تثبيت التبعيات:
```bash
cd src
pip install -r requirements.txt
```

3. تشغيل التطبيق:
```bash
python app.py
```

لوضع التصحيح:
```bash
python app.py debug
```

## نقاط نهاية واجهة برمجة التطبيقات

### تسمية تصنيف واحد

**نقطة النهاية**: `GET /api/<title>`

حل تسمية تصنيف عربي واحد.

**مثال**:
```bash
curl -H "User-Agent: MyBot/1.0" https://yourserver/api/Category%3AExample
```

**الاستجابة**:
```json
{
    "result": "resolved_label",
    "sql": "log_entry_id"
}
```

### المعالجة الجماعية

**نقطة النهاية**: `POST /api/list`

حل تسميات تصنيفات متعددة في وقت واحد.

**محتوى الطلب**:
```json
{
    "titles": ["Category:Example1", "Category:Example2"]
}
```

### السجلات والإحصائيات

- `GET /api/logs_by_day` - الحصول على السجلات مجمعة حسب اليوم
- `GET /api/all` - الحصول على جميع السجلات
- `GET /api/all/<day>` - الحصول على سجلات يوم محدد
- `GET /api/category` - الحصول على السجلات المتعلقة بالتصنيف
- `GET /api/category/<day>` - الحصول على سجلات التصنيف ليوم محدد
- `GET /api/no_result` - الحصول على الإدخالات بدون نتائج
- `GET /api/no_result/<day>` - الحصول على إدخالات بدون نتائج ليوم محدد
- `GET /api/status` - الحصول على جدول الحالة

## مسارات واجهة الويب

- `/` - الواجهة الرئيسية لاختبار حل التصنيفات
- `/list` - واجهة المعالجة الجماعية
- `/chart` - الإحصائيات والرسوم البيانية
- `/logs` - عرض السجلات
- `/logs_by_day` - عرض السجلات مجمعة حسب اليوم

## النشر

### Toolforge

تم تكوين هذه الخدمة للنشر على Wikimedia Toolforge. يتم توفير التكوين في `service.template`:

- **الخلفية**: Kubernetes
- **وقت التشغيل**: Python 3.11
- **المعالج**: 3 أنوية
- **الذاكرة**: 6Gi
- **النسخ المتماثلة**: 2

النشر باستخدام:
```bash
webservice start
```

### UWSGI

تتضمن الخدمة تكوين UWSGI في `src/uwsgi.ini` لعمليات النشر الإنتاجية.

## التطوير

### هيكل المشروع

```
ArWikiCatsWeb/
├── src/
│   ├── app.py              # تطبيق Flask الرئيسي
│   ├── app1.py             # نقطة دخول بديلة
│   ├── logs_bot.py         # وظيفة روبوت السجلات
│   ├── logs_db/            # وحدة تسجيل قاعدة البيانات
│   ├── templates/          # قوالب HTML
│   ├── static/             # الأصول الثابتة (CSS، JS)
│   ├── requirements.txt    # تبعيات Python
│   └── uwsgi.ini          # تكوين UWSGI
├── service.template        # تكوين خدمة Toolforge
├── run.bat                # سكريبت التشغيل لنظام Windows
└── README.md              # هذا الملف
```

### المكونات الرئيسية

- **مكتبة ArWikiCats**: المكتبة الأساسية لحل تسميات التصنيفات العربية
- **تطبيق Flask**: خادم الويب ونقاط نهاية واجهة برمجة التطبيقات
- **نظام السجلات**: تسجيل قائم على SQLite لتتبع الطلبات والأداء
- **تكوين CORS**: يسمح بالطلبات من نطاقات ar.wikipedia.org

## متطلبات واجهة برمجة التطبيقات

يجب أن تتضمن جميع طلبات واجهة برمجة التطبيقات رأس `User-Agent`. الطلبات التي لا تحتوي على هذا الرأس سترجع خطأ 400.

## الترخيص

هذا المشروع جزء من منظمة WikiAr لأدوات ويكيبيديا العربية والمرافق.

## المساهمة

المساهمات مرحب بها! يرجى التأكد من أن الكود الخاص بك يتبع الأسلوب الحالي ويتضمن الاختبارات المناسبة.

## الدعم

للمشاكل والأسئلة، يرجى استخدام متتبع المشاكل على GitHub.
